# SciDataExtractor 📊

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python](https://img.shields.io/badge/Backend-FastAPI-009688.svg)](https://fastapi.tiangolo.com/)
[![React](https://img.shields.io/badge/Frontend-React-61DAFB.svg)](https://reactjs.org/)
[![AI-Assisted](https://img.shields.io/badge/Dev-AI%20Assisted-blueviolet.svg)](https://github.com/yyy-OPS/SciDataExtractor)

**SciDataExtractor** 是一款开源的科学图表数据提取工具，专为科研人员和工程师设计。它结合了计算机视觉与 AI 技术，旨在将论文、报告中的2D科研数据图表通过精确的交互式操作转换为可编辑的 Excel 数据。

---

## ✨ 核心功能

* **📈 颜色分割提取**: 基于 OpenCV 的 HSV 颜色空间分割算法，精准提取指定颜色的曲线数据点。
* **🤖 AI 辅助处理**:
    * **✨ 数据清洗**: 利用 AI 视觉能力，自动识别并剔除提取数据中的网格线干扰、噪点和文字遮挡。
    * **🔧 断点修复**: 针对曲线被遮挡或提取不连续的情况，AI 可自动分析趋势并补全断点。
    * **⚠️ 智能平滑 (实验性)**: 提供基于 AI 的曲线平滑功能（*注：当前版本该功能效果尚不稳定，不推荐在对精度要求极高的场景下使用*）。
* **🎯 精确校准**: 采用交互式手动校准（三点/四点法），确保像素坐标到物理坐标的转换精度，完全由用户掌控。
* **🎨 交互式操作**: 现代化 React 前端，支持框选删除、手动加点、实时预览和撤回/重做。
* **💾 数据导出**: 一键导出标准 Excel (.xlsx) 文件，生成清洗后的高质量数据。

## 🛠️ 技术架构

本项目采用前后端分离架构：

* **前端 (Frontend)**: React 18, Vite, Konva, TailwindCSS
* **后端 (Backend)**: Python 3.11+, FastAPI, OpenCV, OpenAI API, Pandas

## 🚀 快速开始 (Quick Start)

### 环境要求
* Node.js (v16+)
* Python (v3.11+)
* Git

### 1. 下载本项目
```
下载本项目
cd SciDataExtractor
```

### 2. 后端设置

```
cd backend
# 创建虚拟环境（推荐）
python -m venv venv
venv\Scripts\activate  # Windows


# 安装依赖
pip install -r requirements.txt

# (可选)配置环境变量 (复制示例配置并填入 OPENAI_API_KEY)
cp .env.example .env
```

**启动后端:** `python main.py`

### 3. 前端设置

```
cd frontend
npm install
npm run dev
```

访问 `http://localhost:5173` 即可使用。

## 🧠 AI 功能配置

如需使用 **AI 数据清洗** 和 **AI 断点修复** 功能，请在启动后点击界面右上角的 **"AI 配置"**，输入您的 OpenAI 兼容 API Key。

## 标准工作流程

### 步骤 1: 上传图像

1. 点击"选择图像文件"按钮，或直接拖拽图像到界面
2. 也可以使用 Ctrl+V 粘贴剪贴板中的图像
3. 支持 PNG 和 JPG 格式的科学图表

### 步骤 2: 校准坐标系

依次点击图像上的 4 个点，并输入对应的物理值：

1. **X 轴起点**: 点击 X 轴的起始位置，输入起始值（例如：0）
2. **X 轴终点**: 点击 X 轴的结束位置，输入结束值（例如：0.5）
3. **Y 轴起点**: 点击 Y 轴的起始位置，输入起始值（例如：0）
4. **Y 轴终点**: 点击 Y 轴的结束位置，输入结束值（例如：300）

### 步骤 3: 采样颜色

1. 点击你想要提取的曲线上的任意一点
2. 系统会自动识别该点的颜色（HSV 值同时展示RGB组成）
3. 可以调整"颜色容差"滑块来控制匹配范围（推荐 20-40）

### 步骤 4: 提取数据

1. 点击"提取曲线数据"按钮
2. 系统使用计算机视觉算法自动提取曲线
3. 提取的数据点会显示在右侧面板的表格中
4. 同时会在图像上用绿色点标记出来

### 步骤 5: 导出 Excel

1. 点击"导出到 Excel"按钮
2. Excel 文件会自动下载到你的电脑

## AI 辅助工作流程

### 配置 AI 服务

1. 点击右上角"AI 配置"按钮
2. 输入 API 密钥和 API 地址（支持 OpenAI 或兼容服务）
3. 选择模型或者自定义模型

### 使用 AI 功能

1. **曲线修复**: 提取数据后使用"AI 修复曲线"填补断点
2. **数据清洗**: 使用"AI 清洗数据"去除噪点
3. **智能平滑**: 应用"AI 平滑曲线"优化数据质量（质量不好不推荐）

## 高级编辑功能

### 手工重绘模式

1. 启用"手工重绘"模式
2. **单点模式**: 单击鼠标在画布上绘制单个点
3. **拖拽模式**: 按住鼠标左键拖动绘制连续曲线
4. 调整"平滑度"滑块（0-100%）控制曲线平滑程度
5. 设置"点密度"（低/中/高）控制数据点间距

### 区域选择提取

1. 启用"区域选择"模式
2. 在图像上拖拽绘制矩形框
3. 只提取框选区域内的曲线数据
4. 避免提取图表标题、标签等干扰元素

### 选择性删除

1. 启用"选择删除"模式
2. 点击并拖拽选择不需要的数据点
3. 被选中的点会高亮显示
4. 释放鼠标完成删除

### 撤销/重做

- **Ctrl+Z**: 撤销上一步操作
- **Ctrl+Y**: 重做已撤销的操作
- 支持最多 50 步历史记录

## 📄 版权与许可特别说明

**特别说明**：本项目由本人使用 AI 辅助开发。本项目的核心逻辑由本人提出，核心代码、架构设计及功能实现是在人工智能助手的辅助下完成。

License

本程序遵循 MIT License 开源协议。

Copyright © 2026 yyy-OPS. All Rights Reserved.

本项目开源，欢迎用于学习和研究。除依赖库外，你可以自由修改和分发本项目的代码。

------

## ⚠️ 免责声明 (Disclaimer)

1. **辅助工具**: 本软件仅作为科研数据提取的辅助工具。
2. **人工核实**: 自动提取和 AI 修复的数据**可能存在误差**，用于正式论文或工程计算前，**必须**对照原始图表进行人工核实。
3. **责任限制**: 开发者不对因使用本软件数据导致的任何后果承担法律责任。
